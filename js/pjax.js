!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Pjax=t()}}(function(){return function t(e,o,n){function i(r,a){if(!o[r]){if(!e[r]){var c="function"==typeof require&&require;if(!a&&c)return c(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+r+"'")}var l=o[r]={exports:{}};e[r][0].call(l.exports,function(t){var o=e[r][1][t];return i(o?o:t)},l,l.exports,t,e,o,n)}return o[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)i(n[r]);return i}({1:[function(t,e){var o=t("./lib/clone.js"),n=t("./lib/execute-scripts.js"),i=t("./lib/foreach-els.js"),s=t("./lib/uniqueid.js"),r=t("./lib/events/on.js"),a=t("./lib/events/trigger.js"),c=function(e){this.firstrun=!0,t("./lib/proto/parse-options.js").apply(this,[e]),this.log("Pjax options",this.options),this.maxUid=this.lastUid=s(),this.parseDOM(document),r(window,"popstate",function(t){if(t.state){var e=o(this.options);e.url=t.state.url,e.title=t.state.title,e.history=!1,t.state.uid<this.lastUid?e.backward=!0:e.forward=!0,this.lastUid=t.state.uid,this.loadUrl(t.state.url,e)}}.bind(this))};if(c.prototype={log:t("./lib/proto/log.js"),getElements:t("./lib/proto/get-elements.js"),parseDOM:t("./lib/proto/parse-dom.js"),refresh:t("./lib/proto/refresh.js"),reload:t("./lib/reload.js"),attachLink:t("./lib/proto/attach-link.js"),forEachSelectors:function(e,o,n){return t("./lib/foreach-selectors.js").bind(this)(this.options.selectors,e,o,n)},switchSelectors:function(e,o,n,i){return t("./lib/switches-selectors.js").bind(this)(this.options.switches,this.options.switchesOptions,e,o,n,i)},latestChance:function(t){window.location=t},onSwitch:function(){a(window,"resize scroll")},loadContent:function(t,e){var o=document.implementation.createHTMLDocument(),s=/<html[^>]+>/gi,r=/\s?[a-z:]+(?:\=(?:\'|\")[^\'\">]+(?:\'|\"))*/gi,a=t.match(s);if(a&&a.length&&(a=a[0].match(r),a.length&&(a.shift(),a.forEach(function(t){var e=t.trim().split("=");1===e.length?o.documentElement.setAttribute(e[0],!0):o.documentElement.setAttribute(e[0],e[1].slice(1,-1))}))),o.documentElement.innerHTML=t,this.log("load content",o.documentElement.attributes,o.documentElement.innerHTML.length),document.activeElement&&!document.activeElement.value)try{document.activeElement.blur()}catch(t){}this.switchSelectors(this.options.selectors,o,document,e);var c=Array.prototype.slice.call(document.querySelectorAll("[autofocus]")).pop();c&&document.activeElement!==c&&c.focus(),this.options.selectors.forEach(function(t){i(document.querySelectorAll(t),function(t){n(t)})})},doRequest:t("./lib/request.js"),loadUrl:function(t,e){this.log("load href",t,e),a(document,"pjax:send",e),this.doRequest(t,function(o){if(o===!1)return void a(document,"pjax:complete pjax:error",e);document.activeElement.blur();try{this.loadContent(o,e)}catch(e){if(this.options.debug)throw e;return console&&console.error&&console.error("Pjax switch fail: ",e),void this.latestChance(t)}e.history&&(this.firstrun&&(this.lastUid=this.maxUid=s(),this.firstrun=!1,window.history.replaceState({url:window.location.href,title:document.title,uid:this.maxUid},document.title)),this.lastUid=this.maxUid=s(),window.history.pushState({url:t,title:e.title,uid:this.maxUid},e.title,t)),this.forEachSelectors(function(t){this.parseDOM(t)},this),a(document,"pjax:complete pjax:success",e),e.analytics(),e.scrollTo!==!1&&(e.scrollTo.length>1?window.scrollTo(e.scrollTo[0],e.scrollTo[1]):window.scrollTo(0,e.scrollTo))}.bind(this))}},c.isSupported=t("./lib/is-supported.js"),c.isSupported())e.exports=c;else{var l=function(){};for(var u in c.prototype)c.prototype.hasOwnProperty(u)&&"function"==typeof c.prototype[u]&&(l[u]=l);e.exports=l}},{"./lib/clone.js":2,"./lib/events/on.js":4,"./lib/events/trigger.js":5,"./lib/execute-scripts.js":6,"./lib/foreach-els.js":7,"./lib/foreach-selectors.js":8,"./lib/is-supported.js":9,"./lib/proto/attach-link.js":11,"./lib/proto/get-elements.js":12,"./lib/proto/log.js":13,"./lib/proto/parse-dom.js":14,"./lib/proto/parse-options.js":16,"./lib/proto/refresh.js":17,"./lib/reload.js":18,"./lib/request.js":19,"./lib/switches-selectors.js":20,"./lib/uniqueid.js":22}],2:[function(t,e){e.exports=function(t){if(null===t||"object"!=typeof t)return t;var e=t.constructor();for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}},{}],3:[function(t,e){e.exports=function(t){var e=t.text||t.textContent||t.innerHTML||"",o=document.querySelector("head")||document.documentElement,n=document.createElement("script");if(e.match("document.write"))return console&&console.log&&console.log("Script contains document.write. Canâ€™t be executed correctly. Code skipped ",t),!1;n.type="text/javascript";try{n.appendChild(document.createTextNode(e))}catch(t){n.text=e}return o.insertBefore(n,o.firstChild),o.removeChild(n),!0}},{}],4:[function(t,e){var o=t("../foreach-els");e.exports=function(t,e,n,i){e="string"==typeof e?e.split(" "):e,e.forEach(function(e){o(t,function(t){t.addEventListener(e,n,i)})})}},{"../foreach-els":7}],5:[function(t,e){var o=t("../foreach-els");e.exports=function(t,e,n){e="string"==typeof e?e.split(" "):e,e.forEach(function(e){var i;i=document.createEvent("HTMLEvents"),i.initEvent(e,!0,!0),i.eventName=e,n&&Object.keys(n).forEach(function(t){i[t]=n[t]}),o(t,function(t){var e=!1;t.parentNode||t===document||t===window||(e=!0,document.body.appendChild(t)),t.dispatchEvent(i),e&&t.parentNode.removeChild(t)})})}},{"../foreach-els":7}],6:[function(t,e){var o=t("./foreach-els"),n=t("./eval-script");e.exports=function(t){o(t.querySelectorAll("script"),function(t){t.type&&"text/javascript"!==t.type.toLowerCase()||(t.parentNode&&t.parentNode.removeChild(t),n(t))})}},{"./eval-script":3,"./foreach-els":7}],7:[function(t,e){e.exports=function(t,e,o){return t instanceof HTMLCollection||t instanceof NodeList||t instanceof Array?Array.prototype.forEach.call(t,e,o):e.call(o,t)}},{}],8:[function(t,e){var o=t("./foreach-els");e.exports=function(t,e,n,i){i=i||document,t.forEach(function(t){o(i.querySelectorAll(t),e,n)})}},{"./foreach-els":7}],9:[function(t,e){e.exports=function(){return window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/)}},{}],10:[function(){Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),o=this,n=function(){},i=function(){return o.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,i.prototype=new n,i})},{}],11:[function(t,e){t("../polyfills/Function.prototype.bind");var o=t("../events/on"),n=t("../clone"),i="data-pjax-click-state",s=function(t,e){return e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey?void t.setAttribute(i,"modifier"):t.protocol!==window.location.protocol||t.host!==window.location.host?void t.setAttribute(i,"external"):t.pathname===window.location.pathname&&t.hash.length>0?void t.setAttribute(i,"anchor-present"):t.hash&&t.href.replace(t.hash,"")===window.location.href.replace(location.hash,"")?void t.setAttribute(i,"anchor"):t.href===window.location.href.split("#")[0]+"#"?void t.setAttribute(i,"anchor-empty"):(e.preventDefault(),this.options.currentUrlFullReload&&t.href===window.location.href.split("#")[0]?(t.setAttribute(i,"reload"),void this.reload()):(t.setAttribute(i,"load"),void this.loadUrl(t.href,n(this.options))))},r=function(t){return t.defaultPrevented||t.returnValue===!1};e.exports=function(t){var e=this;o(t,"click",function(o){r(o)||s.call(e,t,o)}),o(t,"keyup",function(o){if(!r(o))return o.which>1||o.metaKey||o.ctrlKey||o.shiftKey||o.altKey?void t.setAttribute("data-pjax-keyup-state","modifier"):void(13==o.keyCode&&s.call(e,t,o))}.bind(this))}},{"../clone":2,"../events/on":4,"../polyfills/Function.prototype.bind":10}],12:[function(t,e){e.exports=function(t){return t.querySelectorAll(this.options.elements)}},{}],13:[function(t,e){e.exports=function(){this.options.debug&&console&&("function"==typeof console.log?console.log.apply(console,arguments):console.log&&console.log(arguments))}},{}],14:[function(t,e){var o=t("../foreach-els"),n=t("./parse-element");e.exports=function(t){o(this.getElements(t),n,this)}},{"../foreach-els":7,"./parse-element":15}],15:[function(t,e){e.exports=function(t){switch(t.tagName.toLowerCase()){case"a":t.hasAttribute("data-pjax-click-state")||this.attachLink(t);break;case"form":throw"Pjax doesnt support <form> yet.";default:throw"Pjax can only be applied on <a> or <form> submit"}}},{}],16:[function(t,e){e.exports=function(t){this.options=t,this.options.elements=this.options.elements||"a[href], form[action]",this.options.selectors=this.options.selectors||["title",".js-Pjax"],this.options.switches=this.options.switches||{},this.options.switchesOptions=this.options.switchesOptions||{},this.options.history=this.options.history||!0,this.options.analytics=this.options.analytics||function(){window._gaq&&_gaq.push(["_trackPageview"]),window.ga&&ga("send","pageview",{page:location.pathname,title:document.title})},this.options.scrollTo="undefined"==typeof this.options.scrollTo?0:this.options.scrollTo,this.options.cacheBust="undefined"==typeof this.options.cacheBust||this.options.cacheBust,this.options.debug=this.options.debug||!1,this.options.switches.head||(this.options.switches.head=this.switchElementsAlt),this.options.switches.body||(this.options.switches.body=this.switchElementsAlt),"function"!=typeof t.analytics&&(t.analytics=function(){})}},{}],17:[function(t,e){e.exports=function(t){this.parseDOM(t||document)}},{}],18:[function(t,e){e.exports=function(){window.location.reload()}},{}],19:[function(t,e){e.exports=function(t,e){var o=new XMLHttpRequest;return o.onreadystatechange=function(){4===o.readyState&&(200===o.status?e(o.responseText,o):e(null,o))},this.options.cacheBust&&(t+=(/[?&]/.test(t)?"&":"?")+(new Date).getTime()),o.open("GET",t,!0),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.send(null),o}},{}],20:[function(t,e){var o=t("./foreach-els"),n=t("./switches");e.exports=function(t,e,i,s,r,a){i.forEach(function(i){var c=s.querySelectorAll(i),l=r.querySelectorAll(i);if(this.log&&this.log("Pjax switch",i,c,l),c.length!==l.length)throw"DOM doesnâ€™t look the same on new loaded page: â€™"+i+"â€™ - new "+c.length+", old "+l.length;o(c,function(o,s){var r=l[s];this.log&&this.log("newEl",o,"oldEl",r),t[i]?t[i].bind(this)(r,o,a,e[i]):n.outerHTML.bind(this)(r,o,a)},this)},this)}},{"./foreach-els":7,"./switches":21}],21:[function(t,e){var o=t("./events/on.js");e.exports={outerHTML:function(t,e){t.outerHTML=e.outerHTML,this.onSwitch()},innerHTML:function(t,e){t.innerHTML=e.innerHTML,t.className=e.className,this.onSwitch()},sideBySide:function(t,e,n,i){var s=Array.prototype.forEach,r=[],a=[],c=document.createDocumentFragment(),l="animationend webkitAnimationEnd MSAnimationEnd oanimationend",u=0,h=function(t){t.target==t.currentTarget&&--u<=0&&r&&(r.forEach(function(t){t.parentNode&&t.parentNode.removeChild(t)}),a.forEach(function(t){t.className=t.className.replace(t.getAttribute("data-pjax-classes"),""),t.removeAttribute("data-pjax-classes")}),a=null,r=null,this.onSwitch())}.bind(this);i=i||{},s.call(t.childNodes,function(t){r.push(t),t.classList&&!t.classList.contains("js-Pjax-remove")&&(t.hasAttribute("data-pjax-classes")&&(t.className=t.className.replace(t.getAttribute("data-pjax-classes"),""),t.removeAttribute("data-pjax-classes")),t.classList.add("js-Pjax-remove"),i.callbacks&&i.callbacks.removeElement&&i.callbacks.removeElement(t),i.classNames&&(t.className+=" "+i.classNames.remove+" "+(n.backward?i.classNames.backward:i.classNames.forward)),u++,o(t,l,h,!0))}),s.call(e.childNodes,function(t){if(t.classList){var e="";i.classNames&&(e=" js-Pjax-add "+i.classNames.add+" "+(n.backward?i.classNames.forward:i.classNames.backward)),i.callbacks&&i.callbacks.addElement&&i.callbacks.addElement(t),t.className+=e,t.setAttribute("data-pjax-classes",e),a.push(t),c.appendChild(t),u++,o(t,l,h,!0)}}),t.className=e.className,t.appendChild(c)}}},{"./events/on.js":4}],22:[function(t,e){e.exports=function(){var t=0;return function(){var e="pjax"+(new Date).getTime()+"_"+t;return t++,e}}()},{}]},{},[1])(1)});